<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol{margin:0;padding:0}table td,table th{padding:0}.c0{orphans:2;widows:2;text-align:center;height:10pt}.c1{font-size:10pt;font-family:"Arial";color:#ff0000}.c12{page-break-after:avoid;orphans:2;widows:2}.c6{orphans:2;widows:2;height:10pt}.c29{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c8{background-color:#ffffff;font-size:10.5pt;color:#1d2129}.c3{orphans:2;widows:2;text-align:left}.c20{padding-top:5pt;padding-bottom:5pt;line-height:1.3800000000000001}.c7{font-size:11pt;font-family:"Verdana"}.c28{color:#1155cc;text-decoration:underline}.c27{padding-bottom:5pt;line-height:1.3800000000000001}.c10{font-style:italic;color:#38761d}.c11{font-family:"Verdana";font-style:italic}.c18{font-style:italic;color:#000000}.c35{color:inherit;text-decoration:inherit}.c14{orphans:2;widows:2}.c26{background-color:#ff0000}.c23{color:#999999}.c30{color:#000000}.c19{font-style:italic}.c33{font-size:11pt}.c13{font-family:"Verdana"}.c15{text-align:left}.c22{height:12pt}.c5{color:#ff0000}.c21{color:#38761d}.c2{font-family:"Arial"}.c34{text-indent:36pt}.c25{margin-left:36pt}.c17{text-align:center}.c32{height:14pt}.c24{margin-left:72pt}.c9{color:#0000ff}.c31{background-color:#000000}.c4{font-size:10pt}.c16{font-weight:700}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Verdana";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:center}.subtitle{padding-top:0pt;color:#000000;font-weight:700;font-size:10pt;padding-bottom:0pt;font-family:"Verdana";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:center}li{color:#000000;font-size:10pt;font-family:"Verdana"}p{margin:0;color:#000000;font-size:10pt;font-family:"Verdana"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Verdana";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:center}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Verdana";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:center}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Verdana";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:center}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Verdana";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:center}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Verdana";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:center}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Verdana";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:center}</style></head><body class="c29"><p class="c3"><span class="c33">Most of the robots and schedule entries in this document do not utilize any Wink App robots or Schedules, they are designed to operate independently of the Wink App other than using the devices specified in each flow. When putting a device name into the flow it must match the case, spelling, and spacing EXACTLY as in the Wink App.</span></p><p class="c6"><span></span></p><p class="c3"><span class="c11 c5 c4">Red</span><span class="c11 c4">&nbsp;text should be edited to fit your system</span></p><p class="c3"><span class="c11 c9 c4">Blue</span><span class="c11 c4">&nbsp;text are optional changes</span></p><p class="c3"><span class="c11 c23 c4">Grey</span><span class="c11 c4">&nbsp;may not apply to every system and can be removed</span></p><p class="c3"><span class="c10 c13 c4">Green</span><span class="c11 c4">&nbsp;is information about a specific line</span></p><p class="c6"><span class="c11 c4"></span></p><h3 class="c12 c17" id="h.8ybtazty68m3"><span class="c16">Schedule Entries</span></h3><h4 class="c12 c17" id="h.4xbaee70vt4v"><span>Basic Schedule Entry</span></h4><p class="c0"><span class="c13 c4"></span></p><p class="c3"><span class="c13 c21 c4">At 6:40pm turn the island light on and the living room group and set to 75%</span></p><p class="c6 c15"><span class="c4 c16"></span></p><p class="c3"><span class="c2 c4">if(hours==</span><span class="c1">18</span><span class="c2 c4">&nbsp;&amp; minutes==</span><span class="c1">40</span><span class="c2 c4">) // After dinner </span></p><p class="c3"><span class="c2 c4">{</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; node.send(context.global.executeWinkCMD(&quot;</span><span class="c1">Island</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">light</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">on</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">75</span><span class="c2 c4">&quot;));</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; node.send(context.global.executeWinkCMD(&quot;</span><span class="c1">Living Room</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">group</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">on</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">75</span><span class="c2 c4">&quot;));</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; send_ui_note(&#39;information&#39;,</span><span class="c1">10</span><span class="c2 c4">*60*1000,&#39;</span><span class="c1">Island and Living Room at 75% via schedule</span><span class="c2 c4">&#39;,Math.floor(Math.random()*1000));</span></p><p class="c3"><span class="c2 c4">}</span></p><p class="c6"><span class="c4"></span></p><h4 class="c12 c17" id="h.67hzbdzaaz5k"><span>Fade In Schedule Entry</span></h4><p class="c3"><span class="c21">At 6:30am on weekdays fade the bedroom lamp from 0 to 100 over a 900 second period</span></p><p class="c6 c15"><span class="c21"></span></p><p class="c3"><span class="c2">if(hours==</span><span class="c5 c2">6</span><span class="c2">&nbsp;&amp; minutes==</span><span class="c5 c2">30</span><span class="c2">&nbsp;&amp;&amp; intday!==0 &amp;&amp; intday!=6) </span></p><p class="c3"><span class="c2">{ &nbsp;</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; effect=&quot;fadein&quot;;</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; o_name=&quot;</span><span class="c5 c2">Bedroom</span><span class="c2">&quot;;</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; o_type=&quot;</span><span class="c5 c2">light</span><span class="c2">&quot;;</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; min=</span><span class="c5 c2">0</span><span class="c2">;</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; max=</span><span class="c5 c2">100</span><span class="c2">;</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; period=</span><span class="c5 c2">900</span><span class="c2">;</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; WinkCMDmsg = context.global.executeEffectCMD(effect,o_name,o_type,min,max,period);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; send_ui_note(&#39;information&#39;,</span><span class="c5 c2">10</span><span class="c2">*60*1000,&#39;</span><span class="c5 c2">Good Morning Fade In</span><span class="c2">&#39;,Math.floor(Math.random()*1000));</span></p><p class="c3"><span class="c2">}</span></p><p class="c6 c15"><span class="c4"></span></p><p class="c3"><span class="c10 c13 c4">Note: intday!==0 &amp;&amp; intday!=6 means not Sunday or Saturday</span></p><p class="c0"><span class="c13 c4 c16"></span></p><p class="c0"><span class="c13 c4 c16"></span></p><h4 class="c12 c17" id="h.310jlfz5daoz"><span>Sunrise based Schedule Entry</span></h4><p class="c3"><span class="c10 c13 c4">Lights on at Dawn</span></p><p class="c6 c15"><span class="c21"></span></p><p class="c3"><span class="c2 c4">if(hours==(context.global.sunTimes.goldenHour.hour) &amp;&amp; minutes==context.global.sunTimes.goldenHour.minute)</span><span class="c21 c2 c4">&nbsp;</span><span class="c10 c4">// Indoor Lights at Dawn</span></p><p class="c3"><span class="c2 c4">{</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; node.send(context.global.executeWinkCMD(&quot;</span><span class="c1">Living Room</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">group</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">on</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">100</span><span class="c2 c4">&quot;));</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; node.send(context.global.executeWinkCMD(&quot;</span><span class="c1">Kitchen</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">group</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">on</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">100</span><span class="c2 c4">&quot;));</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; send_ui_note(&#39;information&#39;,</span><span class="c1">10</span><span class="c2 c4">*60*1000,&#39;</span><span class="c1">Kitchen and Living Room on via schedule</span><span class="c2 c4">&#39;,Math.floor(Math.random()*1000));</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; </span></p><p class="c3"><span class="c2 c4">}</span></p><h4 class="c12 c22" id="h.augan154zuz7"><span class="c30 c4"></span></h4><h4 class="c12" id="h.y92aj1our2a9"><span>Turns lights off an hour after Sunrise</span></h4><p class="c6"><span class="c13 c4"></span></p><p class="c3"><span class="c2 c4">if(hours==(context.global.Weather.SunriseHour+1) &amp;&amp; minutes==context.global.Weather.SunriseMin) </span></p><p class="c3"><span class="c21 c4">//</span><span class="c21">&nbsp;</span><span class="c10 c4">Indoor Lights off after sunrise</span></p><p class="c3"><span class="c2 c4">{</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; node.send(context.global.executeWinkCMD(&quot;</span><span class="c1">Living Room</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">group</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">off</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">0</span><span class="c2 c4">&quot;));</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; node.send(context.global.executeWinkCMD(&quot;</span><span class="c1">Kitchen</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">group</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">off</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">0</span><span class="c2 c4">&quot;));</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; send_ui_note(&#39;information&#39;,</span><span class="c1">10</span><span class="c2 c4">*60*1000,&#39;</span><span class="c1">Kitchen and Living Room off via schedule</span><span class="c2 c4">&#39;,Math.floor(Math.random()*1000));</span></p><p class="c3"><span class="c2 c4">}</span></p><p class="c6"><span class="c4"></span></p><p class="c6"><span class="c4 c16"></span></p><p class="c6 c15"><span class="c13 c4"></span></p><p class="c6 c15"><span class="c4"></span></p><p class="c6 c15"><span class="c4"></span></p><hr style="page-break-before:always;display:none;"><p class="c6 c15"><span class="c4"></span></p><h3 class="c12 c17" id="h.ud03g62zvm8a"><span>Robots</span></h3><h4 class="c12 c15 c24" id="h.5j6ilx80gah3"><span>Outlink on at certain times when door opens</span></h4><p class="c0"><span class="c13 c4 c16"></span></p><p class="c3"><span class="c10 c13 c4">Times aren&rsquo;t easily used in robot tab so I have created variables in the schedules tab that define certain times.</span></p><p class="c6 c15"><span class="c4"></span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 416.00px; height: 92.00px;"><img alt="time constraints guide.JPG" src="images/image01.jpg" style="width: 416.00px; height: 92.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6 c15"><span class="c4"></span></p><p class="c3"><span class="c10 c13 c4">The time is defined in the schedules tab then the variable is called on in the robots tab this example shows my earlyMorning variable but it could be named any unique name</span></p><p class="c6 c15"><span class="c2 c4"></span></p><p class="c3"><span class="c2 c4">if(typeof context.global.earlyMorning==&quot;undefined&quot;)</span></p><p class="c3"><span class="c2 c4">{</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; context.global.earlyMorning=false;</span></p><p class="c3"><span class="c2 c4">}</span></p><p class="c3"><span class="c2 c4">if ((context.global.earlyMorning===false) &amp;&amp; ((hours==</span><span class="c1">5</span><span class="c2 c4">&nbsp;&amp;&amp; minutes&gt;=</span><span class="c1">45</span><span class="c2 c4">) || (hours==</span><span class="c1">6 </span><span class="c2 c4">&amp;&amp; minutes&lt;=</span><span class="c1">45</span><span class="c2 c4">)))</span></p><p class="c3"><span class="c2 c4">{</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; context.global.earlyMorning=true;</span></p><p class="c3"><span class="c2 c4">}</span></p><p class="c3"><span class="c2 c4">if((context.global.earlyMorning===true) &amp;&amp; (((hours&gt;=</span><span class="c1">6</span><span class="c2 c4">) &amp;&amp; (hours&lt;=</span><span class="c1">23</span><span class="c2 c4">)) &amp;&amp; ((hours&gt;=</span><span class="c1">0</span><span class="c2 c4">) &amp;&amp; (hours&lt;=</span><span class="c1">5</span><span class="c2 c4">))))</span></p><p class="c3"><span class="c2 c4">{</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; context.global.earlyMorning=false;</span></p><p class="c3"><span class="c2 c4">}</span></p><p class="c3"><span class="c2 c4">if(context.global.DEBUG){ node.warn(context.global.earlyMorning); } // Debug conditional</span></p><p class="c6 c15"><span class="c2 c4"></span></p><p class="c6 c15"><span class="c4"></span></p><p class="c3"><span class="c10 c13 c4">Then this is in the robots tab</span></p><p class="c6 c15"><span class="c13 c4"></span></p><p class="c3"><span class="c2 c4">if ((context.global.earlyMorning==&quot;true&quot;) &amp;&amp; (changed.name==&quot;</span><span class="c1">Front Door</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state!==&quot;Opened&quot; &amp;&amp; changed.new_state==&quot;Opened&quot; ))</span></p><p class="c3"><span class="c2 c4">{</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; try {</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; node.send(context.global.executeWinkCMD(&quot;</span><span class="c1">Master Bath</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">light</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">on</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">100</span><span class="c2 c4">&quot;));</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; node.send(context.global.send_ui_note(&#39;information&#39;,</span><span class="c2 c9 c4">600000</span><span class="c2 c4">,&#39;</span><span class="c1">Early Morning Bath Heat On</span><span class="c2 c4">&#39;,Math.floor(Math.random()*1000)));</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; }</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; catch(error){</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; node.warn(error.message);</span></p><p class="c3"><span class="c2 c4">}}</span></p><p class="c6 c15"><span class="c13 c4"></span></p><p class="c6 c15"><span class="c13 c4"></span></p><p class="c3"><span class="c10 c13 c4">I use a delay timer to turn the &ldquo;Master Bath&rdquo; outlink off after 30 minutes</span></p><p class="c6 c15"><span class="c13 c4"></span></p><p class="c3"><span class="c2 c4">if (changed.name==&quot;</span><span class="c1">Master Bath</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state.powered==&quot;Off&quot; &amp;&amp; changed.new_state.powered==&quot;On&quot;)</span></p><p class="c3"><span class="c2 c4">{</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; setTimeout(function(){</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; try {</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; node.send(context.global.executeWinkCMD(&quot;</span><span class="c1">Master Bath</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">light</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">off</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">0</span><span class="c2 c4">&quot;));</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; node.send(context.global.send_ui_note(&#39;information&#39;,</span><span class="c2 c9 c4">600000</span><span class="c2 c4">,&#39;</span><span class="c1">Master Bath off</span><span class="c2 c4">&#39;,Math.floor(Math.random()*1000)));</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; }</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; catch(error){</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; node.warn(error.message);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; }</span></p><p class="c3"><span class="c2 c4">},</span><span class="c1">30</span><span class="c2 c4">*60*1000 );</span></p><p class="c3"><span class="c2 c4">}</span></p><p class="c6 c15"><span class="c2 c4"></span></p><p class="c6 c15"><span class="c2 c4"></span></p><p class="c3"><span class="c2 c4">The line },</span><span class="c1">30</span><span class="c2 c4">*60*1000 ); is defining the delay by },minutes x seconds x milliseconds;</span></p><p class="c6"><span class="c2 c4"></span></p><p class="c6"><span class="c2 c4"></span></p><hr style="page-break-before:always;display:none;"><p class="c6"><span class="c13 c4"></span></p><h4 class="c12" id="h.59tibk68pmo3"><span>Light or group off when another light is turned off</span></h4><p class="c0"><span class="c13 c4"></span></p><p class="c0"><span class="c13 c4"></span></p><p class="c14"><span class="c10 c13 c4">This robot turns all kitchen lights off when the island is turned on and left on for 15 minutes between 9pm and 5am. Use case would be someone forgetting to turn the light off.</span></p><p class="c6"><span class="c13 c4"></span></p><p class="c3"><span class="c2 c4">// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Kitchen off with island at night</span></p><p class="c3"><span class="c2 c4">if ((changed.name==&quot;</span><span class="c1">Island</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state.powered==&quot;Off&quot; &amp;&amp; changed.new_state.powered==&quot;On&quot;) &amp;&amp; (</span><span class="c23 c2 c4">(context.global.lateEvening===true)||(context.global.overnight===true)</span><span class="c2 c4">))</span></p><p class="c3"><span class="c2 c4">{</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; setTimeout(function(){</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; if(context.global.winkState.light_bulbs.</span><span class="c1">Island</span><span class="c2 c4">.powered===true)</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp;try {</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(context.global.executeWinkCMD(&quot;</span><span class="c1">Kitchen</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">group</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">off</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">0</span><span class="c2 c4">&quot;));</span></p><p class="c3"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(context.global.send_ui_note(&#39;information&#39;,</span><span class="c2 c9 c4">300000</span><span class="c2 c4">,&#39;</span><span class="c1">Island left on</span><span class="c2 c4">&#39;,Math.floor(Math.random()*1000)));</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; catch(error){</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.warn(error.message);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; } ,</span><span class="c1">15</span><span class="c2 c4">*60*1000 );</span></p><p class="c3"><span class="c2 c4">}</span></p><p class="c6"><span class="c13 c4"></span></p><p class="c6"><span class="c13 c4"></span></p><p class="c6"><span class="c13 c4"></span></p><h4 class="c12" id="h.ak6c89clt6j"><span>Light on when another light is turned on</span></h4><p class="c0"><span class="c13 c4"></span></p><p class="c3"><span class="c10 c4">// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Cabinet on with Island evening</span></p><p class="c3"><span class="c2 c4">if ((changed.name==&quot;</span><span class="c1">Island</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state.powered==&quot;Off&quot; &amp;&amp; changed.new_state.powered==&quot;On&quot;) </span><span class="c23 c2 c4">&amp;&amp; ((context.global.evening==&quot;true&quot;)||(context.global.lateEvening===true))</span><span class="c2 c4">)</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; try {</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; node.send(context.global.executeWinkCMD(&quot;</span><span class="c1">Cabinet</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">group</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">on</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">100</span><span class="c2 c4">&quot;));</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; node.send(context.global.send_ui_note(&#39;information&#39;,300000,&#39;</span><span class="c1">Cabinet on with Island</span><span class="c2 c4">&#39;,Math.floor(Math.random()*1000)));</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; }</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; catch(error){</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; node.warn(error.message);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; }</span></p><p class="c6"><span class="c2 c4"></span></p><p class="c6"><span class="c4"></span></p><p class="c6"><span class="c4"></span></p><p class="c6"><span class="c4"></span></p><p class="c6"><span class="c4"></span></p><p class="c0"><span class="c13 c4"></span></p><p class="c0"><span class="c13 c4"></span></p><p class="c6"><span class="c4"></span></p><h4 class="c12" id="h.kdnrezh4s7pw"><span>Light on when a door opens then have it fade back to previous state</span></h4><p class="c14 c17"><span class="c13 c4">Thanks Ken Vermillion</span></p><p class="c0"><span class="c13 c4"></span></p><p class="c3"><span class="c10 c13 c4">Anything following&rdquo;//&rdquo; is a note for information about the line</span></p><p class="c6 c15"><span class="c11 c4"></span></p><p class="c3"><span class="c10 c4">// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Light on when front door opens at night</span></p><p class="c3"><span class="c2 c4">if ((changed.name==&quot;</span><span class="c1">Front Door</span><span class="c2 c4">&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;)</span><span class="c23 c2 c4">&nbsp;&amp;&amp; ((context.global.overnight===true )||(context.global.lateEvening===true))</span><span class="c2 c4">) //check if front door opens</span></p><p class="c3"><span class="c2 c4">{</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; if (context.global.winkState.light_bulbs[&#39;</span><span class="c1">Center Can</span><span class="c2 c4">&#39;].powered===true)</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; {</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; var lrlamp = (context.global.winkState.light_bulbs[&#39;</span><span class="c1">Center Can</span><span class="c2 c4">&#39;].brightness)*100;</span></p><p class="c3"><span class="c19 c4">&nbsp;</span><span class="c10 c4">// sets variable to current brightness of </span><span class="c19 c5 c4">Center Can</span></p><p class="c6 c15"><span class="c2 c4"></span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; node.send(context.global.executeWinkCMD(&quot;</span><span class="c1">Center Can</span><span class="c2 c4">&quot;,&quot;</span><span class="c2 c4">light</span><span class="c2 c4">&quot;,&quot;on&quot;,&quot;</span><span class="c1">50</span><span class="c2 c4">&quot;));</span><span class="c21 c2 c4">&nbsp;</span></p><p class="c3"><span class="c10 c4">// now turn light to 50% brightness</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; node.send(WinkCMDmsg);</span></p><p class="c6 c15"><span class="c2 c4"></span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; var timerId = setTimeout(function()</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; {node.send(context.global.executeWinkCMD(&quot;</span><span class="c1">Center Can</span><span class="c2 c4">&quot;,&quot;light&quot;,&quot;on&quot;,lrlamp));</span></p><p class="c3"><span class="c19 c4">&nbsp;</span><span class="c4 c10">// turn same light back to previous brightness after 45 seconds</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; node.send(WinkCMDmsg)},</span><span class="c1">45000</span><span class="c2 c4">);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; }</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; else</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; {</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; node.send(context.global.executeWinkCMD(&quot;</span><span class="c1">Center Can</span><span class="c2 c4">&quot;,&quot;light&quot;,&quot;on&quot;,&quot;</span><span class="c1">50</span><span class="c2 c4">&quot;)); </span></p><p class="c3"><span class="c10 c4">// now turn light to 50% brightness</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; node.send(WinkCMDmsg);</span></p><p class="c6 c15"><span class="c2 c4"></span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; var timerId = setTimeout(function()</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; {node.send(context.global.executeWinkCMD(&quot;</span><span class="c1">Center Can</span><span class="c2 c4">&quot;,&quot;light&quot;,&quot;off&quot;)); </span></p><p class="c3"><span class="c10 c4">// turn same light back to previous brightness after 45 seconds</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; node.send(WinkCMDmsg)},</span><span class="c1">45000</span><span class="c2 c4">);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; }</span></p><p class="c3"><span class="c2 c4">}</span></p><p class="c6"><span class="c4"></span></p><p class="c6"><span class="c4"></span></p><p class="c6"><span class="c4"></span></p><h4 class="c12" id="h.iuvx0qargqdz"><span>Lock door during overnight if closed for 5 mins</span></h4><p class="c0"><span class="c19 c4 c16"></span></p><p class="c3"><span class="c2 c4">if ((changed.name==&quot;</span><span class="c1">Main Door</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state!==&quot;Closed&quot; &amp;&amp; changed.new_state==&quot;Closed&quot; ) &amp;&amp; (context.global.overnight===true)) </span></p><p class="c3"><span class="c2 c4">&nbsp; {</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; setTimeout(function(){</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; </span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; try {</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c4">// This command locks main &nbsp;door if closed for 5 mins during overnight</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WinkCMDmsg = context.global.executeWinkCMD(&quot;</span><span class="c1">Entry Lock</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">lock</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">lock</span><span class="c2 c4">&quot;);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; send_ui_note(&#39;information&#39;,</span><span class="c2 c9 c4">30</span><span class="c2 c4">*60*1000,</span><span class="c1">&#39;Overnight locking front door</span><span class="c2 c4">&#39;,Math.floor(Math.random()*1000));</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; catch(error){</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.warn(message);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; },</span><span class="c2 c9 c4">300000</span><span class="c2 c4">);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; }</span></p><h4 class="c12" id="h.3emikcxd7pwn"><span>Turn on a light using a tripper</span></h4><p class="c6"><span class="c4"></span></p><p class="c3"><span class="c2 c4">if (changed.name==&quot;</span><span class="c1">Attic</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state!==&quot;Opened&quot; &amp;&amp; changed.new_state==&quot;Opened&quot; )</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; {</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; try {</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10 c4">&nbsp;// This command turns my Hallway light on to 100%</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WinkCMDmsg = context.global.executeWinkCMD(&quot;</span><span class="c1">Attic Light</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">light</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">On</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">100</span><span class="c2 c4">&quot;);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; catch(error){</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.warn(error.message);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; }</span></p><h4 class="c12 c22" id="h.ictdjqnojnt5"><span></span></h4><hr style="page-break-before:always;display:none;"><h4 class="c12 c22" id="h.l8wore3ek3ju"><span></span></h4><h4 class="c12" id="h.cxvxw9gkfzst"><span>Turn off a light using a tripper</span></h4><p class="c0"><span class="c19 c4 c16"></span></p><p class="c3"><span class="c2 c4">&nbsp;if (changed.name==&quot;</span><span class="c1">Attic</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state!==&quot;Closed&quot; &amp;&amp; changed.new_state==&quot;Closed&quot; )</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; {</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; try {</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10 c4">// This command turns my Hallway light on to 100%</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WinkCMDmsg = context.global.executeWinkCMD(&quot;</span><span class="c1">Attic Light</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">light</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">Off</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">0</span><span class="c2 c4">&quot;);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; catch(error){</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.warn(error.message);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; }</span></p><p class="c6"><span class="c4"></span></p><p class="c14"><span class="c4">&nbsp; &nbsp;</span></p><p class="c0"><span class="c19 c4 c16"></span></p><p class="c0"><span class="c19 c4 c16"></span></p><p class="c14"><span class="c4">&nbsp; &nbsp;</span></p><p class="c14"><span class="c4">&nbsp; &nbsp;</span></p><p class="c6"><span class="c4"></span></p><p class="c6"><span class="c4"></span></p><p class="c6"><span class="c4"></span></p><p class="c6"><span class="c4"></span></p><p class="c6"><span class="c4"></span></p><p class="c6"><span class="c4"></span></p><p class="c6 c15"><span class="c4"></span></p><p class="c6"><span class="c4"></span></p><p class="c6"><span class="c4"></span></p><p class="c6"><span class="c4"></span></p><p class="c6 c15"><span class="c4 c16"></span></p><h3 class="c12 c15 c34 c25" id="h.t60mw4ur8c1g"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></h3><hr style="page-break-before:always;display:none;"><h3 class="c12 c15 c25 c32 c34" id="h.sk0mmtxmb54q"><span></span></h3><h3 class="c12 c25" id="h.oatezjp8gpxo"><span>Advanced Schedules and Robots</span></h3><h4 class="c12" id="h.kygh28lowf5y"><span class="c30">Shuts Leaksmart valve if sensors detect a leak</span></h4><p class="c6"><span></span></p><p class="c3"><span class="c2">if ((changed.name==&#39;</span><span class="c5 c2">Laundry Water Sensor</span><span class="c2">&#39; || changed.name==&#39;</span><span class="c5 c2">Kitchen Water Sensor</span><span class="c2">&#39; || changed.name==&#39;</span><span class="c5 c2">Bathroom Water Sensor</span><span class="c2">&#39;) &amp;&amp; (changed.old_state!==true &amp;&amp; changed.new_state===true))</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; try {</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // This command shuts water off in house if a leak is detected</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WinkCMDmsg = context.global.executeWinkCMD(&quot;</span><span class="c5 c2">Water Shut Off</span><span class="c2">&quot;,&quot;valve&quot;,&quot;</span><span class="c5 c2">close</span><span class="c2">&quot;);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pmsg=context.global.sendViaPushBullet(&#39;note&#39;,&quot;</span><span class="c5 c2">Water leak detected by </span><span class="c2">&quot; + changed.name + &quot;</span><span class="c5 c2">&nbsp;main valve closed</span><span class="c2">&quot;,&#39;</span><span class="c5 c2">Water leak in house&#39;</span><span class="c2">);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(pmsg);</span></p><p class="c6 c15"><span class="c2"></span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; catch(error){</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.warn(error.message);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c14"><span>&nbsp;</span></p><p class="c6"><span></span></p><p class="c6"><span></span></p><h4 class="c12" id="h.b7ggyvb6usu2"><span class="c30">Turn on lights when Ring Doorbell detects motion and turn them off again 10 minutes after motion stops. Also will only run if the house is empty (no presence)</span></h4><p class="c6"><span></span></p><p class="c3"><span class="c2">if ((changed.name==&#39;</span><span class="c5 c2">Doorbell</span><span class="c2">&#39; &amp;&amp; changed.old_state!==true &amp;&amp; changed.new_state===true) &amp;&amp; (!context.global.checkPresence()))</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; try {</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // This command turns on certsain lights when the door detects motion</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WinkCMDmsg = context.global.executeWinkCMD(&quot;</span><span class="c5 c2">Couch lamp</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">light</span><span class="c2">&quot;,&quot;</span><span class="c2 c5">on</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">100</span><span class="c2">&quot;);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WinkCMDmsg = context.global.executeWinkCMD(&quot;</span><span class="c5 c2">Sabra lamp</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">light</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">on</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">100</span><span class="c2">&quot;);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WinkCMDmsg = context.global.executeWinkCMD(&quot;</span><span class="c5 c2">Hallway Light</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">light</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">on</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">100</span><span class="c2">&quot;);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp;WinkCMDmsg = context.global.executeWinkCMD(&quot;</span><span class="c5 c2">Living Room Celing</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">group</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">on</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">100</span><span class="c2">&quot;);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pmsg=context.global.sendViaPushBullet(&#39;note&#39;,&#39;</span><span class="c5 c2">Motion detect lights on</span><span class="c2">&#39;,&#39;</span><span class="c5 c2">Who goes there</span><span class="c2">&#39;);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(pmsg);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; catch(error){</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.warn(error.message);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c14"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6"><span class="c2"></span></p><hr style="page-break-before:always;display:none;"><p class="c6"><span class="c2"></span></p><p class="c14"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c3"><span class="c2">if ((changed.name==&#39;</span><span class="c5 c2">Doorbell</span><span class="c2">&#39; &amp;&amp; changed.old_state!==false &amp;&amp; changed.new_state===false) &amp;&amp; (!context.global.checkPresence())) &nbsp; &nbsp; &nbsp; &nbsp;</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; {</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; var timer = setTimeout(function()</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (context.global.winkState.sensor_pods[&#39;</span><span class="c5 c2">Doorbell</span><span class="c2">&#39;].motion===false) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WinkCMDmsg = context.global.executeWinkCMD(&quot;</span><span class="c5 c2">Couch lamp</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">light</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">off</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">0</span><span class="c2">&quot;);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WinkCMDmsg = context.global.executeWinkCMD(&quot;</span><span class="c5 c2">Sabra lamp</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">light</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">off</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">0</span><span class="c2">&quot;);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WinkCMDmsg = context.global.executeWinkCMD(&quot;</span><span class="c5 c2">Hallway Light</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">light</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">off</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">0</span><span class="c2">&quot;);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WinkCMDmsg = context.global.executeWinkCMD(&quot;</span><span class="c5 c2">Living Room Ceiling</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">group</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">off</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">0</span><span class="c2">&quot;);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pmsg=context.global.sendViaPushBullet(&#39;note&#39;,&#39;</span><span class="c5 c2">No motion lights off</span><span class="c2">&#39;,&#39;</span><span class="c5 c2">all quiet</span><span class="c2">&#39;);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(pmsg);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; catch(error){</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.warn(error.message);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2">}</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },</span><span class="c2 c9">600000</span><span class="c2">);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; } &nbsp; &nbsp;</span></p><p class="c14"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6"><span class="c2"></span></p><p class="c6"><span class="c2"></span></p><p class="c6"><span></span></p><h4 class="c12" id="h.l4xvl754tkhq"><span class="c30">Turn humidifier on and off using Spotter or any other device that reports humidity levels</span></h4><p class="c6"><span></span></p><p class="c3"><span class="c2">if (typeof context.global.highHumidity==&quot;undefined&quot;)</span></p><p class="c3"><span class="c2">{</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; context.global.highHumidity=0;</span></p><p class="c3"><span class="c2">}</span></p><p class="c6 c15"><span class="c2"></span></p><p class="c3"><span class="c2">if(context.global.winkState.sensor_pods[&#39;</span><span class="c5 c2">Master Bedroom</span><span class="c2">&#39;].humidity&lt;=</span><span class="c5 c2">0.34</span><span class="c2">&nbsp;&amp;&amp; context.global.highHumidity===0)</span></p><p class="c3"><span class="c2">{</span></p><p class="c3"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try {</span></p><p class="c3"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WinkCMDmsg = context.global.executeWinkCMD(&quot;</span><span class="c5 c2">Humidifier</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">light</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">on</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">100</span><span class="c2">&quot;);</span></p><p class="c3"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;send_ui_note(&#39;information&#39;,30*60*1000,&#39;</span><span class="c5 c2">Low Humidity Detected</span><span class="c2">&#39;,Math.floor(Math.random()*1000));</span></p><p class="c3"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c3"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;context.global.highHumidity=1;</span></p><p class="c3"><span class="c2">}</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; catch(error){</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.warn(message);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2">}</span></p><p class="c6 c15"><span class="c2"></span></p><p class="c6 c15"><span class="c2"></span></p><p class="c3"><span class="c2">if(context.global.winkState.sensor_pods[&#39;</span><span class="c5 c2">Master Bedroom</span><span class="c2">&#39;].humidity&gt;</span><span class="c5 c2">0.35</span><span class="c2">&nbsp;&amp;&amp; context.global.highHumidity===1)</span></p><p class="c3"><span class="c2">{</span></p><p class="c3"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try{</span></p><p class="c3"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WinkCMDmsg = context.global.executeWinkCMD(&quot;</span><span class="c5 c2">Humidifier</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">light</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">off</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">0</span><span class="c2">&quot;);</span></p><p class="c3"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;send_ui_note(&#39;information&#39;,30*60*1000,&#39;</span><span class="c5 c2">High Humidity Detected</span><span class="c2">&#39;,Math.floor(Math.random()*1000));</span></p><p class="c3"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c3"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;context.global.highHumidity=0;</span></p><p class="c3"><span class="c2">}</span></p><p class="c3"><span class="c2">catch(error){</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.warn(message);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c6 c15"><span class="c2"></span></p><p class="c3"><span class="c2">}</span></p><p class="c6"><span class="c2"></span></p><p class="c6"><span class="c2"></span></p><hr style="page-break-before:always;display:none;"><p class="c6"><span class="c2"></span></p><p class="c6"><span class="c2"></span></p><h4 class="c12 c17" id="h.qwsqv1chhxg3"><span>Using Echo via IFTTT to set variables and trigger WNR actions</span></h4><p class="c6"><span class="c4 c16"></span></p><p class="c14"><span class="c10 c13 c4">Create IFTTT recipe with Echo custom Phrase as If then Maker as below changing highlighted to your url</span></p><p class="c6"><span class="c13 c4"></span></p><p class="c14"><span class="c11 c4">See &nbsp;</span><span class="c11 c4 c28"><a class="c35" href="https://www.google.com/url?q=https://github.com/tfatykhov/WinkRedNode/blob/master/README-IFTTT.md&amp;sa=D&amp;ust=1471031733358000&amp;usg=AFQjCNF87VtCuNu80RKs7Z8icE9VOaO6Ig">https://github.com/tfatykhov/WinkRedNode/blob/master/README-IFTTT.md</a></span><span class="c11 c4">&nbsp;for help with IFTTT integration</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 2.67px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 619.00px; height: 508.50px;"><img alt="bedtime ifttt.JPG" src="images/image00.jpg" style="width: 619.00px; height: 508.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6"><span class="c4 c16"></span></p><p class="c6"><span class="c4 c16"></span></p><p class="c6"><span class="c4"></span></p><p class="c6"><span class="c4"></span></p><p class="c6"><span class="c4"></span></p><hr style="page-break-before:always;display:none;"><p class="c6"><span class="c4"></span></p><p class="c6"><span class="c4"></span></p><p class="c14"><span class="c10 c13 c4">The schedule entry below is triggered by the above Echo/IFTTT event and turns off the Kitchen Group, Bedroom Group, Left Lamp, and sets the Right Lamp to 1%. It also sends a message to the activity feed and sets my alarm variable to 1 (arms alarm).</span><span class="c11 c4">&nbsp;</span></p><p class="c6"><span class="c13 c4"></span></p><p class="c3"><span class="c5 c4 c11">Red</span><span class="c11 c4">&nbsp;text should be edited to fit your system</span></p><p class="c3"><span class="c11 c9 c4">Blue</span><span class="c11 c4">&nbsp;text is optional changes</span></p><p class="c3"><span class="c11 c4 c23">Grey</span><span class="c11 c4">&nbsp;may not apply to every system and can be removed</span></p><p class="c6 c15"><span class="c11 c4"></span></p><p class="c3"><span class="c10 c13 c4">It is important to make sure that your device names match the Wink names exactly in case, spelling, and spacing</span></p><p class="c6 c15"><span class="c19 c4"></span></p><p class="c6 c15"><span class="c4 c26"></span></p><p class="c3"><span class="c2 c4">if(context.global.bedtimeEvent==&quot;true&quot;)</span></p><p class="c3"><span class="c2 c4">try {</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; node.send(context.global.executeWinkCMD(&quot;</span><span class="c1">Kitchen</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">group</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">off</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">0</span><span class="c2 c4">&quot;));</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; node.send(context.global.executeWinkCMD(&quot;</span><span class="c1">Bedroom</span><span class="c2 c4">&quot;,</span><span class="c1">&quot;group</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">off</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">0</span><span class="c2 c4">&quot;));</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; node.send(context.global.executeWinkCMD(&quot;</span><span class="c1">Left lamp</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">light</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">off</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">0</span><span class="c2 c4">&quot;));</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; node.send(context.global.executeWinkCMD(&quot;</span><span class="c1">Right lamp</span><span class="c2 c4">&quot;,&quot;l</span><span class="c1">ight</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">on</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">1</span><span class="c2 c4">&quot;));</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; node.send(context.global.send_ui_note(&#39;information&#39;,</span><span class="c2 c9 c4">300000</span><span class="c2 c4">,&#39;</span><span class="c1">House is set for bedtime mode</span><span class="c2 c4">&#39;,Math.floor(Math.random()*1000)));</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; </span><span class="c23 c2 c4">context.global.alarmArmed=1;</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; context.global.bedtimeEvent=false;</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; </span></p><p class="c3"><span class="c2 c4">}</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; catch(error){</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; node.warn(error.message);</span></p><p class="c3"><span class="c2 c4">}</span></p><p class="c6 c15"><span class="c4"></span></p><p class="c6 c15"><span class="c13 c4"></span></p><p class="c3"><span class="c10 c13 c4">When you say &ldquo;trigger bedtime&rdquo; ,or whatever phrase, the variable is made true and the above fires then changes variable back to false.</span></p><p class="c6 c15"><span class="c4"></span></p><p class="c6 c15"><span class="c4"></span></p><h4 class="c12" id="h.p42wd34nljc9"><span>Bloomsky Integrated Lights</span></h4><p class="c3"><span class="c10 c13 c4">This schedule entry turns lights off during the day if the Bloomsky reads a luminance of above 3350 between one hour after sunrise and one hour before sunset and someone is home and on if the reading is below 3350</span></p><p class="c6 c15"><span class="c4"></span></p><p class="c3"><span class="c2">if(hours &gt; context.global.Weather.SunriseHour+1 &amp;&amp; hours &lt; context.global.Weather.SunsetHour-1 &amp;&amp; context.global.checkPresence())</span></p><p class="c3"><span class="c2">{</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; setTimeout(function()</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; {</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; if(context.global.Weather.Bloomsky.Luminance&lt;3350 &amp;&amp; context.global.winkState.light_bulbs[&#39;Left lamp&#39;].powered===false)</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WinkCMDmsg=context.global.executeWinkCMD(&quot;Livingroom&quot;,&quot;group&quot;,&quot;on&quot;,&quot;100&quot;);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; send_ui_note(&#39;information&#39;,30*60*1000,&#39;Cloudy day lights turning on&#39;,Math.floor(Math.random()*1000));</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; else if(context.global.Weather.Bloomsky.Luminance&gt;=3350 &amp;&amp; context.global.winkState.light_bulbs[&#39;Left lamp&#39;].powered===true)</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WinkCMDmsg=context.global.executeWinkCMD(&quot;Livingroom&quot;,&quot;group&quot;,&quot;off&quot;,&quot;0&quot;);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; send_ui_note(&#39;information&#39;,30*60*1000,&#39;Sunny day lights turning off&#39;,Math.floor(Math.random()*1000));</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; },10*60*1000);</span></p><p class="c3"><span class="c2">}</span></p><p class="c6 c15"><span class="c2"></span></p><p class="c6"><span class="c4"></span></p><p class="c6"><span></span></p><h4 class="c12" id="h.kq2z0x1yhhh4"><span>Change Nest Thermostat depending on an individual&rsquo;s presence</span></h4><p class="c3"><span class="c10">// if Angie presence is yes and after 8am and before 5pm and temp outside is over 77 degrees and Angie home during day isn&#39;t already running.</span></p><p class="c6 c15"><span class="c21 c2"></span></p><p class="c3"><span class="c2">if(context.global.Presence.</span><span class="c5 c2">Angie</span><span class="c2">.home==&quot;no&quot;)</span></p><p class="c3"><span class="c2">{</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; context.global.AngieHome=false;</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; context.global.AngieHomeDuringDay=0;</span></p><p class="c3"><span class="c2">}</span></p><p class="c6 c15"><span class="c2"></span></p><p class="c3"><span class="c2">if(context.global.Presence.</span><span class="c5 c2">Angie</span><span class="c2">.home===&quot;undefined&quot;)</span></p><p class="c3"><span class="c2">{</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; context.global.AngieHome=false;</span></p><p class="c3"><span class="c2">}if((context.global.AngieHome===true) &amp;&amp; (hours&gt;=</span><span class="c5 c2">8</span><span class="c2">) &amp;&amp; (hours</span><span class="c5 c2">&lt;=17)</span><span class="c2">&nbsp;&amp;&amp; (context.global.Weather.Bloomsky.TemperatureF&gt;=</span><span class="c5 c2">77</span><span class="c2">) &amp;&amp; context.global.AngieHomeDuringDay!=1)</span></p><p class="c3"><span class="c2">{</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; node.send(context.global.executeTstatCMD(&#39;</span><span class="c5 c2">Home Home Thermostat</span><span class="c2">&#39;,&#39;</span><span class="c5 c2">cool_start_at</span><span class="c2">&#39;,&#39;</span><span class="c5 c2">23.5</span><span class="c2">&#39;));</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; send_ui_note(&#39;information&#39;,</span><span class="c5 c2">300</span><span class="c2">*60*1000,&#39;</span><span class="c5 c2">A/C set to 74</span><span class="c2">&#39;,Math.floor(Math.random()*1000));</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; context.global.AngieHomeDuringDay=1;</span></p><p class="c3"><span class="c2">}</span></p><p class="c6 c15"><span class="c2"></span></p><p class="c3"><span class="c2">if(context.global.Presence.</span><span class="c5 c2">Angie</span><span class="c2">.home==&quot;yes&quot;)</span></p><p class="c3"><span class="c2">{</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; context.global.AngieHome=true;</span></p><p class="c3"><span class="c2">}</span></p><p class="c6 c15"><span class="c2"></span></p><p class="c6 c15"><span class="c2"></span></p><p class="c6 c15"><span class="c2"></span></p><p class="c6"><span></span></p><p class="c6"><span></span></p><p class="c6 c20"><span class="c8"></span></p><p class="c6 c20"><span class="c8"></span></p><p class="c6"><span class="c4"></span></p><hr style="page-break-before:always;display:none;"><p class="c6"><span class="c4"></span></p><h3 class="c12 c17" id="h.bezlhkff6p35"><span>Start of PushBullet Notification flows. These go in robot tab.</span></h3><p class="c6"><span></span></p><p class="c14 c17"><span class="c11">Basic entry to send PushBullet Notification in Robots</span></p><p class="c6"><span class="c11"></span></p><p class="c14"><span class="c11 c4">pmsg=context.global.sendViaPushBullet(&#39;note&#39;,&#39;</span><span class="c11 c5 c4">Header</span><span class="c11 c4">&#39;,&#39;</span><span class="c11 c5 c4">Message</span><span class="c11 c4">&#39;);</span></p><p class="c14"><span class="c11 c4">node.send(pmsg);</span></p><p class="c6"><span class="c11 c4"></span></p><p class="c6"><span></span></p><p class="c0"><span class="c11 c4 c16"></span></p><p class="c14 c17"><span class="c19 c16">Lower Cabinet Opened</span></p><p class="c14 c17"><span class="c10">This flow notifies me if any of my lower cabinets are opened for more than 5 secs. Helps me know if my little girl is getting into stuff that she shouldn&rsquo;t.</span></p><p class="c6"><span class="c11 c4"></span></p><p class="c3"><span class="c2 c4">&nbsp;if ((changed.name==&quot;</span><span class="c1">Kitchen Sink</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state!==&quot;Opened&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;) || (changed.name==&quot;</span><span class="c1">Pantry</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state!==&quot;Opened&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;) || (changed.name==&quot;</span><span class="c1">Corner</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state!==&quot;Opened&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;) || (changed.name==&quot;</span><span class="c1">Pots And Pans</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state!==&quot;Opened&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;) || (changed.name==&quot;</span><span class="c1">Bread</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state!==&quot;Opened&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;) || (changed.name==&quot;</span><span class="c1">Can Goods</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state!==&quot;Opened&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;) || (changed.name==&quot;</span><span class="c1">Baking</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state!==&quot;Opened&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;) || (changed.name==&quot;</span><span class="c1">Crock Pot</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state!==&quot;Opened&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;))</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; {</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; setTimeout(function()</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ((changed.name==&quot;</span><span class="c1">Kitchen Sink</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state!==&quot;Opened&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;) || (changed.name==&quot;</span><span class="c1">Pantry</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state!==&quot;Opened&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;) || (changed.name==&quot;</span><span class="c1">Corner</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state!==&quot;Opened&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;) || (changed.name==&quot;</span><span class="c1">Pots And Pans</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state!==&quot;Opened&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;) || (changed.name==&quot;</span><span class="c1">Bread</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state!==&quot;Opened&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;) || (changed.name==&quot;</span><span class="c1">Can Goods</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state!==&quot;Opened&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;) || (changed.name==&quot;</span><span class="c1">Baking</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state!==&quot;Opened&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;) || (changed.name==&quot;</span><span class="c1">Crock Pot</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state!==&quot;Opened&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;))</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pmsg=context.global.sendViaPushBullet(&#39;note&#39;, changed.name + &#39; </span><span class="c1">Cabinet Opened</span><span class="c2 c4">&#39;,&#39;</span><span class="c1">Where is Nikki</span><span class="c2 c4">&#39;);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(pmsg);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; catch(error){</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.warn(error.message);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },</span><span class="c2 c9 c4">5000</span><span class="c2 c4">);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; }</span></p><p class="c14"><span class="c11 c4">&nbsp; &nbsp;</span></p><p class="c14"><span class="c11 c4">&nbsp; &nbsp; </span></p><h4 class="c12" id="h.mpzg0rtqhj0w"><span>Door Locked</span></h4><p class="c0"><span class="c10 c13 c4 c16"></span></p><p class="c14 c17"><span class="c10 c4 c13">This flow notifies me when my front door is locked</span></p><p class="c6"><span class="c11 c4"></span></p><p class="c3"><span class="c2 c4">if (changed.name==&quot;</span><span class="c1">Entry Lock</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state!==&quot;Locked&quot; &amp;&amp; changed.new_state==&quot;Locked&quot;)</span></p><p class="c3"><span class="c2 c4">try{</span></p><p class="c3"><span class="c2 c4">&nbsp;pmsg=context.global.sendViaPushBullet(&#39;note&#39;,&#39;</span><span class="c1">Front Door Locked</span><span class="c2 c4">&#39;,&#39;</span><span class="c1">House is locked</span><span class="c2 c4">&#39;);</span></p><p class="c3"><span class="c2 c4">node.send(pmsg);</span></p><p class="c3"><span class="c2 c4">}</span></p><p class="c3"><span class="c2 c4">catch(error){</span></p><p class="c3"><span class="c2 c4">node.warn(error.message);</span></p><p class="c3"><span class="c2 c4">}</span></p><p class="c6"><span class="c11 c4"></span></p><h4 class="c12" id="h.qfzjxml53zy8"><span>Door Unlocked</span></h4><p class="c0"><span class="c10 c13 c4 c16"></span></p><p class="c14 c17"><span class="c10 c13 c4">This flow notifies me when my front door unlocks</span></p><p class="c6"><span class="c11 c4"></span></p><p class="c3"><span class="c2 c4">&nbsp;if (changed.name==&quot;</span><span class="c1">Entry Lock</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state!==&quot;Unlocked&quot; &amp;&amp; changed.new_state==&quot;Unlocked&quot;)</span></p><p class="c3"><span class="c2 c4">try{</span></p><p class="c3"><span class="c2 c4">&nbsp;pmsg=context.global.sendViaPushBullet(&#39;note&#39;,&#39;</span><span class="c1">Front Door Unlocked</span><span class="c2 c4">&#39;,&#39;</span><span class="c1">House is unlocked</span><span class="c2 c4">&#39;);</span></p><p class="c3"><span class="c2 c4">node.send(pmsg);</span></p><p class="c3"><span class="c2 c4">}</span></p><p class="c3"><span class="c2 c4">catch(error){</span></p><p class="c3"><span class="c2 c4">node.warn(error.message);</span></p><p class="c3"><span class="c2 c4">}</span></p><p class="c14"><span class="c11 c4">&nbsp;</span></p><h4 class="c12" id="h.oeolxv9kspa6"><span>Mail is Here</span></h4><p class="c0"><span class="c11 c4 c16"></span></p><p class="c14 c17"><span class="c10 c13 c4">This flow notifies me when my mailbox is opened</span></p><p class="c0"><span class="c11 c4 c16"></span></p><p class="c0"><span class="c11 c4 c16"></span></p><p class="c6"><span class="c11 c4"></span></p><p class="c3"><span class="c2 c4">&nbsp;if (changed.name==&quot;</span><span class="c1">Mailbox</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state!==&quot;Opened&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;)</span></p><p class="c3"><span class="c2 c4">try{</span></p><p class="c3"><span class="c2 c4">&nbsp;pmsg=context.global.sendViaPushBullet(&#39;note&#39;,&#39;</span><span class="c1">Mail is here</span><span class="c2 c4">&#39;,&#39;</span><span class="c1">Mailbox opened</span><span class="c2 c4">&#39;);</span></p><p class="c3"><span class="c2 c4">node.send(pmsg);</span></p><p class="c3"><span class="c2 c4">}</span></p><p class="c3"><span class="c2 c4">catch(error){</span></p><p class="c3"><span class="c2 c4">node.warn(error.message);</span></p><p class="c3"><span class="c2 c4">}</span></p><p class="c6"><span class="c11 c4"></span></p><p class="c6"><span class="c11 c4"></span></p><p class="c6"><span class="c11 c4"></span></p><p class="c6"><span class="c11 c4"></span></p><p class="c6"><span class="c11 c4"></span></p><h4 class="c12" id="h.he4c6feg6y1p"><span>Propane is Low</span></h4><p class="c0"><span class="c11 c4 c16"></span></p><p class="c14 c17"><span class="c10 c13 c4">This flow notifies me when my propane levels get low on my barbcue.</span></p><p class="c6"><span class="c11 c4"></span></p><p class="c3"><span class="c2 c4">&nbsp;if (changed.name==&quot;</span><span class="c1">Grill Tank</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state&gt;=&quot;</span><span class="c1">.2</span><span class="c2 c4">&quot; &amp;&amp; changed.new_state&lt;&quot;</span><span class="c1">.2</span><span class="c2 c4">&quot;)</span></p><p class="c3"><span class="c2 c4">try{</span></p><p class="c3"><span class="c2 c4">&nbsp;pmsg=context.global.sendViaPushBullet(&#39;note&#39;,&#39;</span><span class="c1">Propane is low</span><span class="c2 c4">&#39;,&#39;</span><span class="c1">Replace propane tank</span><span class="c2 c4">&#39;);</span></p><p class="c3"><span class="c2 c4">node.send(pmsg);</span></p><p class="c3"><span class="c2 c4">}</span></p><p class="c3"><span class="c2 c4">catch(error){</span></p><p class="c3"><span class="c2 c4">node.warn(error.message);</span></p><p class="c3"><span class="c2 c4">}</span></p><p class="c6 c15"><span class="c11 c4"></span></p><h4 class="c12" id="h.vu7p8tnqv8ef"><span>Fridge Left Open</span></h4><p class="c0"><span class="c11 c4 c16"></span></p><p class="c14 c17"><span class="c10 c13 c4">This flow notifies me if my Fridge door was left open for 5 mins.</span></p><p class="c6"><span class="c11 c4"></span></p><p class="c3"><span class="c2 c4">&nbsp;if (changed.name==&quot;</span><span class="c1">Fridge</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state==&quot;Closed&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;)</span></p><p class="c3"><span class="c2 c4">{</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; setTimeout(function(){</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; if(changed.name==&quot;</span><span class="c1">Fridge</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state==&quot;Closed&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;)</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; try{</span></p><p class="c3"><span class="c2 c4">&nbsp;pmsg=context.global.sendViaPushBullet(&#39;note&#39;,&#39;</span><span class="c1">Fridge left open</span><span class="c2 c4">&#39;,&#39;</span><span class="c1">Close the refrigerator</span><span class="c2 c4">&#39;);</span></p><p class="c3"><span class="c2 c4">node.send(pmsg);</span></p><p class="c3"><span class="c2 c4">}</span></p><p class="c3"><span class="c2 c4">catch(error){</span></p><p class="c3"><span class="c2 c4">node.warn(error.message);</span></p><p class="c3"><span class="c11 c4">}</span></p><p class="c3"><span class="c11 c4">} ,</span><span class="c11 c9 c4">300000</span><span class="c11 c4">);</span></p><p class="c3"><span class="c13 c4">}</span></p><p class="c6"><span class="c11 c4"></span></p><p class="c6"><span class="c19"></span></p><hr style="page-break-before:always;display:none;"><p class="c6"><span class="c19"></span></p><p class="c6"><span class="c19"></span></p><h4 class="c12" id="h.tgke56bzyg7v"><span>Freezer Left Open</span></h4><p class="c0"><span class="c11 c4 c16"></span></p><p class="c14 c17"><span class="c10 c13 c4">This flow notifies me if my Freezer door was left open for 5 mins.</span></p><p class="c6"><span class="c11 c4"></span></p><p class="c3"><span class="c11 c4">&nbsp;</span><span class="c2 c4">if (changed.name==&quot;</span><span class="c1">Freezer</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state==&quot;Closed&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;)</span></p><p class="c3"><span class="c2 c4">{</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; setTimeout(function(){</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; if(changed.name==&quot;</span><span class="c1">Freezer</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state==&quot;Closed&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;)</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; try{</span></p><p class="c3"><span class="c2 c4">&nbsp;pmsg=context.global.sendViaPushBullet(&#39;note&#39;,&#39;</span><span class="c1">Freezer left open</span><span class="c2 c4">&#39;,&#39;</span><span class="c1">Close the freezer</span><span class="c2 c4">&#39;);</span></p><p class="c3"><span class="c2 c4">node.send(pmsg);</span></p><p class="c3"><span class="c2 c4">}</span></p><p class="c3"><span class="c2 c4">catch(error){</span></p><p class="c3"><span class="c2 c4">node.warn(error.message);</span></p><p class="c3"><span class="c2 c4">}</span></p><p class="c3"><span class="c2 c4">} ,</span><span class="c2 c9 c4">300000</span><span class="c2 c4">);</span></p><p class="c3"><span class="c2 c4">}</span></p><h3 class="c12 c15 c32" id="h.scyio7ji2l54"><span></span></h3><h3 class="c12 c17" id="h.3dl6gqurzbhz"><span>Presence Based Robots</span></h3><p class="c6"><span></span></p><p class="c14"><span class="c10 c13 c4">To check for someone&rsquo;s presence in an if statement use </span><span class="c10 c4">context.global.checkPresence() </span></p><p class="c6"><span class="c4"></span></p><h4 class="c12" id="h.d8be0z6j42ja"><span>Day Presence</span></h4><p class="c3"><span class="c2 c4">if(typeof context.global.nopresence==&quot;undefined&quot;)</span></p><p class="c3"><span class="c2 c4">{</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; context.global.nopresence=0;</span></p><p class="c3"><span class="c2 c4">}</span></p><p class="c3"><span class="c2 c4">// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;No Presence Day</span></p><p class="c3"><span class="c2 c4">if(context.global.daylight==1 &amp;&amp; !context.global.checkPresence() &amp;&amp; context.global.nopresence==1)</span></p><p class="c3"><span class="c2 c4">{</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; node.send(context.global.executeWinkCMD(&quot;</span><span class="c1">All Lights</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">group</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">off</span><span class="c2 c4">&quot;,&quot;</span><span class="c1">0</span><span class="c2 c4">&quot;));</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; node.send(context.global.executeTstatCMD(&#39;</span><span class="c1">Home Home Thermostat</span><span class="c2 c4">&#39;,&#39;</span><span class="c1">users_away</span><span class="c2 c4">&#39;,&#39;</span><span class="c1">true</span><span class="c2 c4">&#39;));</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; node.send(context.global.send_ui_note(&#39;information&#39;,</span><span class="c1">300</span><span class="c2 c4">*60*1000,&#39;</span><span class="c1">No one is home, setting system to away mode</span><span class="c2 c4">&#39;,Math.floor(Math.random()*1000)));</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; pmsg=context.global.sendViaPushBullet(&#39;note&#39;,&#39;</span><span class="c1">No Presence</span><span class="c2 c4">&#39;,&#39;</span><span class="c1">The house has been set to away mode</span><span class="c2 c4">&#39;);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; node.send(pmsg);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; context.global.nopresence=0;</span></p><p class="c3"><span class="c2 c4">}</span></p><p class="c6 c15"><span class="c2"></span></p><p class="c3"><span class="c2 c4">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Presence Day</span></p><p class="c3"><span class="c2 c4">if(context.global.daylight==1 &amp;&amp; context.global.checkPresence() &amp;&amp; context.global.nopresence===0)</span></p><p class="c3"><span class="c2 c4">{</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; node.send(context.global.executeTstatCMD(&#39;</span><span class="c1">Home Home Thermostat</span><span class="c2 c4">&#39;,&#39;</span><span class="c1">users_away</span><span class="c2 c4">&#39;,&#39;</span><span class="c1">false</span><span class="c2 c4">&#39;));</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; node.send(context.global.send_ui_note(&#39;information&#39;,</span><span class="c1">300</span><span class="c2 c4">*60*1000,&#39;</span><span class="c1">Welcome Home</span><span class="c2 c4">&#39;,Math.floor(Math.random()*1000)));</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; pmsg=context.global.sendViaPushBullet(&#39;note&#39;,&#39;</span><span class="c1">Presence</span><span class="c2 c4">&#39;,&#39;</span><span class="c1">Welcome Home, house set for presence</span><span class="c2 c4">&#39;);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; node.send(pmsg);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; context.global.nopresence=1;</span></p><p class="c3"><span class="c2 c4">}</span></p><h4 class="c12" id="h.h42kpdwlkx55"><span>Night Presence</span></h4><p class="c3"><span>// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2">No Presence Night</span></p><p class="c3"><span class="c2">if(context.global.daylight===0 &amp;&amp; !context.global.checkPresence() &amp;&amp; context.global.nopresence==1)</span></p><p class="c3"><span class="c2">{</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; node.send(context.global.executeWinkCMD(&quot;</span><span class="c5 c2">Kitchen</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">group</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">off</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">0</span><span class="c2">&quot;));</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; node.send(context.global.executeWinkCMD(&quot;</span><span class="c5 c2">Bedroom</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">group</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">off</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">0</span><span class="c2">&quot;));</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; node.send(context.global.executeWinkCMD(&quot;</span><span class="c5 c2">Right Lamp</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">light</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">on</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">20</span><span class="c2">&quot;));</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; node.send(context.global.executeWinkCMD(&quot;</span><span class="c5 c2">Left Lamp</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">light</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">off</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">0</span><span class="c2">&quot;));</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; node.send(context.global.executeTstatCMD(&#39;</span><span class="c5 c2">Home Home Thermostat</span><span class="c2">&#39;,&#39;</span><span class="c5 c2">users_away</span><span class="c2">&#39;,&#39;</span><span class="c5 c2">true</span><span class="c2">&#39;));</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; send_ui_note(&#39;information&#39;,</span><span class="c5 c2">300</span><span class="c2">*60*1000,&#39;</span><span class="c5 c2">No one is home, setting house to away mode</span><span class="c2">&#39;,Math.floor(Math.random()*1000));</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; pmsg=context.global.sendViaPushBullet(&#39;note&#39;,&#39;</span><span class="c5 c2">No Presence</span><span class="c2">&#39;,&#39;</span><span class="c5 c2">The house has been set to away mode</span><span class="c2">&#39;);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; node.send(pmsg);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; context.global.nopresence=0;</span></p><p class="c3"><span class="c2">}</span></p><p class="c3"><span class="c2">// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Presence Night</span></p><p class="c3"><span class="c2">if(context.global.daylight===0 &amp;&amp; context.global.checkPresence() &amp;&amp; context.global.nopresence===0)</span></p><p class="c3"><span class="c2">{</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; node.send(context.global.executeTstatCMD(&#39;</span><span class="c5 c2">Home Home Thermostat</span><span class="c2">&#39;,&#39;</span><span class="c5 c2">users_away</span><span class="c2">&#39;,&#39;</span><span class="c5 c2">false</span><span class="c2">&#39;));</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; node.send(context.global.executeWinkCMD(&quot;</span><span class="c5 c2">Left Lamp</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">light</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">on</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">50</span><span class="c2">&quot;));</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; node.send(context.global.executeWinkCMD(&quot;</span><span class="c5 c2">Right Lamp</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">light</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">on</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">50</span><span class="c2">&quot;));</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; node.send(context.global.send_ui_note(&#39;information&#39;,</span><span class="c5 c2">300</span><span class="c2">*60*1000,&#39;</span><span class="c5 c2">Welcome Home</span><span class="c2">&#39;,Math.floor(Math.random()*1000)));</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; pmsg=context.global.sendViaPushBullet(&#39;note&#39;,&#39;</span><span class="c5 c2">Presence</span><span class="c2">&#39;,&#39;</span><span class="c5 c2">Welcome Home, house set for presence</span><span class="c2">&#39;);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; node.send(pmsg);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; context.global.nopresence=1;</span></p><p class="c3"><span class="c2">}</span></p><p class="c6 c15"><span class="c2"></span></p><p class="c6"><span class="c2"></span></p><p class="c6"><span></span></p><p class="c6"><span></span></p><p class="c0"><span class="c4"></span></p><p class="c0"><span class="c4"></span></p><p class="c14 c17"><span class="c4">T</span><span class="c19 c4">his robot activates the wink PRESENCE shortcut if Ken arrives and Katie was already home</span></p><p class="c14 c17"><span class="c4 c19">Thanks Ken</span></p><p class="c14"><span class="c4">&nbsp;</span></p><p class="c3"><span class="c2 c4">if(changed.name==&quot;</span><span class="c1">Ken</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state===false &amp;&amp; changed.new_state===true)</span></p><p class="c3"><span class="c4">&nbsp; </span><span class="c10 c4">// check if Ken&#39;s presence is now detected</span></p><p class="c3"><span class="c19 c2 c4">{</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(context.global.winkState.sensor_pods.Katie.presence===true)</span></p><p class="c3"><span class="c4">&nbsp;</span><span class="c10 c4">// check if Katie is already home</span></p><p class="c3"><span class="c4">&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2 c4">{</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c23 c2 c4">node.warn(&quot;</span><span class="c1">you&#39;ve made it past the katie home kenny arrive check</span><span class="c23 c2 c4">&quot;);</span></p><p class="c3"><span class="c10 c4">// This is a test message in activity feed that verifies that the above has been completed</span></p><p class="c3"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2 c4">try {</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WinkCMDmsg = context.global.executeWinkCMD(&quot;PRESENCE&quot;,&quot;shortcut&quot;); </span></p><p class="c3"><span class="c10 c4">// activate PRESENCE shortcut</span></p><p class="c3"><span class="c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2 c4">node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;catch(error){</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.warn(error.message);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp; </span></p><p class="c3"><span class="c2 c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c6"><span></span></p><h3 class="c12 c17" id="h.811txhkj623k"><span>Alarm Robots</span></h3><h4 class="c12" id="h.5zpb4t6via12"><span>Alarm checks if door was opened by a recent arrival</span></h4><p class="c14"><span class="c10">This alarm checks for a family member&#39;s arrival after sensing door opening. If no arrival within the specified time and failsafe switch is not on the alarm sounds</span></p><p class="c14"><span class="c10">&nbsp;</span></p><p class="c3"><span class="c10">// This part goes in schedule tab</span></p><p class="c6 c15"><span></span></p><p class="c3"><span class="c2">&nbsp;// testing arrival</span></p><p class="c3"><span class="c2">var d = new Date();</span></p><p class="c3"><span class="c2">var t = d.getTime()/1000; //this will calculate current time on the server in your local time zone</span></p><p class="c3"><span class="c2">var </span><span class="c5 c2">k</span><span class="c2">diff = Math.trunc((t -context.global.winkState.sensor_pods.</span><span class="c5 c2">Kaitlen</span><span class="c2">_Geo.lastUpdated)/60); // this will give you difference in minutes.</span></p><p class="c3"><span class="c2">var </span><span class="c5 c2">a</span><span class="c2">diff = Math.trunc((t -context.global.winkState.sensor_pods.</span><span class="c5 c2">Angie</span><span class="c2">_Geo.lastUpdated)/60); // this will give you difference in minutes.</span></p><p class="c3"><span class="c2">var </span><span class="c5 c2">s</span><span class="c2">diff = Math.trunc((t -context.global.winkState.sensor_pods.</span><span class="c5 c2">Scott</span><span class="c2">_Geo.lastUpdated)/60); // this will give you difference in minutes.</span></p><p class="c6 c15"><span class="c2"></span></p><p class="c3"><span class="c2">if(</span><span class="c5 c2">k</span><span class="c2">diff&lt;=</span><span class="c5 c2">10</span><span class="c2">&nbsp;&amp;&amp; context.global.winkState.sensor_pods.</span><span class="c5 c2">Kaitlen</span><span class="c2">_Geo.lastEvent==&quot;enter&quot; &amp;&amp; context.global.winkState.sensor_pods.</span><span class="c5 c2">Kaitlen</span><span class="c2">_Geo.lastWaypoint==&quot;home&quot;)</span></p><p class="c3"><span class="c2">{</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; context.global.someoneArrived=true;{</span></p><p class="c3"><span class="c2">setTimeout(function(){</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c3"><span class="c2">&nbsp; &nbsp; context.global.someoneArrived=false;</span></p><p class="c3"><span class="c2">},</span><span class="c5 c2">6</span><span class="c2">*60*1000 );</span></p><p class="c3"><span class="c2">}}</span></p><p class="c6 c15"><span class="c2"></span></p><p class="c3"><span class="c2">if(</span><span class="c5 c2">a</span><span class="c2">diff&lt;=</span><span class="c5 c2">5</span><span class="c2">&nbsp;&amp;&amp; context.global.winkState.sensor_pods.</span><span class="c5 c2">Angie</span><span class="c2">_Geo.lastEvent==&quot;enter&quot; &amp;&amp; context.global.winkState.sensor_pods.</span><span class="c5 c2">Angie</span><span class="c2">_Geo.lastWaypoint==&quot;home&quot;)</span></p><p class="c3"><span class="c2">{</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; context.global.someoneArrived=true;{</span></p><p class="c3"><span class="c2">setTimeout(function(){</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c3"><span class="c2">&nbsp; &nbsp; context.global.someoneArrived=false;</span></p><p class="c3"><span class="c2">},</span><span class="c5 c2">6</span><span class="c2">*60*1000 );</span></p><p class="c3"><span class="c2">}}</span></p><p class="c6 c15"><span class="c2"></span></p><p class="c3"><span class="c2">if(</span><span class="c5 c2">s</span><span class="c2">diff&lt;=</span><span class="c5 c2">5</span><span class="c2">&nbsp;&amp;&amp; context.global.winkState.sensor_pods.</span><span class="c5 c2">Scott</span><span class="c2">_Geo.lastEvent==&quot;enter&quot; &amp;&amp; context.global.winkState.sensor_pods.</span><span class="c5 c2">Scott</span><span class="c2">_Geo.lastWaypoint==&quot;home&quot;)</span></p><p class="c3"><span class="c2">{</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; context.global.someoneArrived=true;{</span></p><p class="c3"><span class="c2">setTimeout(function(){</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c3"><span class="c2">&nbsp; &nbsp; context.global.someoneArrived=false;</span></p><p class="c3"><span class="c2">},</span><span class="c5 c2">6</span><span class="c2">*60*1000 );</span></p><p class="c3"><span class="c2">}}</span></p><p class="c6 c15"><span class="c2"></span></p><p class="c3"><span class="c2">if(typeof context.global.someoneArrived==&quot;undefined&quot;)</span></p><p class="c3"><span class="c2">{</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; context.global.someoneArrived=false;</span></p><p class="c3"><span class="c2">}</span></p><p class="c6 c15"><span class="c2"></span></p><p class="c3"><span class="c10">// This is the actual alarm robot</span></p><p class="c6 c15"><span class="c2"></span></p><p class="c3"><span class="c2">if ((changed.name==&quot;</span><span class="c5 c2">Front Door</span><span class="c2">&quot;||changed.name==&quot;</span><span class="c5 c2">Back Door</span><span class="c2">&quot;) &amp;&amp; (changed.old_state==&quot;Closed&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;)&amp;&amp; context.global.alarmArmed==1)</span></p><p class="c3"><span class="c2">{</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; setTimeout(function(){</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; if((context.global.winkState.light_bulbs.</span><span class="c5 c2">Island</span><span class="c2">.powered===false) &amp;&amp; (context.global.someoneArrived===false))</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp;try {</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(context.global.executeWinkCMD(&#39;Siren&#39;,&#39;siren&#39;,&#39;siren_only&#39;,&#39;null&#39;));</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(context.global.send_ui_note(&#39;information&#39;,600000,changed.name +&#39; &nbsp;Alarm!!!&#39;,Math.floor(Math.random()*1000)));</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pmsg=context.global.sendViaPushBullet(&#39;note&#39;, changed.name + &#39; Alarm!!!&#39;,&#39;alarm has been triggered&#39;);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(pmsg);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; catch(error){</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.warn(error.message);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; } ,30*1000 );</span></p><p class="c3"><span class="c2">}</span></p><p class="c6 c15"><span class="c2"></span></p><h4 class="c12" id="h.xf6qu88o49hl"><span>Front Door Opens with No One Home</span></h4><p class="c14 c17"><span class="c10 c13 c4">This robot detects front door open when no one is home, if the island light is not turned on within 30 seconds the siren is activated and I get a pushbullet notification.</span></p><p class="c0"><span class="c13 c4"></span></p><p class="c3"><span class="c2 c4">if ((changed.name==&quot;</span><span class="c1">Front Door</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state==&quot;Closed&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;) &amp;&amp; (!context.global.checkPresence())</span><span class="c23 c2 c4">&nbsp;&amp;&amp; context.global.duringDay==&quot;true&quot; </span><span class="c2 c4">)</span></p><p class="c3"><span class="c2 c4">{</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; setTimeout(function(){</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; if((context.global.winkState.light_bulbs.</span><span class="c1">Island</span><span class="c2 c4">.powered===false) &amp;&amp; (!context.global.checkPresence()))</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp;try {</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(context.global.executeWinkCMD(&#39;Siren&#39;,&#39;siren&#39;,&#39;siren_only&#39;,&#39;null&#39;));</span></p><p class="c3"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(context.global.send_ui_note(&#39;information&#39;,600000,&#39;Door Alarm!!!&#39;,Math.floor(Math.random()*1000)));</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pmsg=context.global.sendViaPushBullet(&#39;note&#39;,&#39;</span><span class="c1">Alarm!!!</span><span class="c2 c4">&#39;,&#39;</span><span class="c1">alarm has been triggered by front door</span><span class="c2 c4">&#39;);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(pmsg);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; catch(error){</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.warn(error.message);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; } ,</span><span class="c1">30</span><span class="c2 c4">*1000 );</span></p><p class="c3"><span class="c2 c4">}</span></p><h4 class="c12" id="h.a987vvwj8lm2"><span>Front Door Opens with Individual Arrival</span></h4><p class="c14 c17"><span class="c10 c13 c4">This robot detects front door open and if alarm is armed using alarmArmed variable==1 it waits 30 seconds then checks to see if Kaitlen just arrived. If she didn&rsquo;t just arrive it activates siren and notifies via pushbullet. Also has the failsafe of Island being turned on to prevent alarm</span></p><p class="c0"><span class="c13 c4"></span></p><p class="c3"><span class="c2 c4">if ((changed.name==&quot;</span><span class="c1">Front Door</span><span class="c2 c4">&quot; &amp;&amp; changed.old_state==&quot;Closed&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;) &amp;&amp; context.global.alarmArmed==1)</span></p><p class="c3"><span class="c2 c4">{</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; setTimeout(function(){</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; if(((context.global.winkState.sensor_pods.</span><span class="c1">Kaitlen</span><span class="c2 c4">.presence===false)) &amp;&amp; (context.global.winkState.light_bulbs[&#39;</span><span class="c1">Island</span><span class="c2 c4">&#39;].powered===false))</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp;try {</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(context.global.executeWinkCMD(&#39;Siren&#39;,&#39;siren&#39;,&#39;siren_and_strobe&#39;,&#39;null&#39;));</span></p><p class="c3"><span class="c2">node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(context.global.send_ui_note(&#39;information&#39;,600000,&#39;</span><span class="c1">Door Alarm!!!</span><span class="c2 c4">&#39;,Math.floor(Math.random()*1000)));</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pmsg=context.global.sendViaPushBullet(&#39;note&#39;,&#39;</span><span class="c1">Alarm!!!&#39;,&#39;alarm has been triggered by front door</span><span class="c2 c4">&#39;);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(pmsg);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; catch(error){</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.warn(error.message);</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2 c4">&nbsp; &nbsp; } ,</span><span class="c1">30</span><span class="c2 c4">*1000 );</span></p><p class="c3"><span class="c2 c4">}</span></p><p class="c6"><span></span></p><p class="c6"><span></span></p><p class="c6"><span></span></p><h3 class="c12 c17" id="h.k54e54821szd"><span>Motion Based Robots</span></h3><p class="c6"><span></span></p><h4 class="c12" id="h.j3wr43f7mjqh"><span class="c16 c18">Close Garage Door after 30 seconds if no motion</span></h4><p class="c6"><span class="c19 c16"></span></p><p class="c3"><span class="c2">if (changed.name==&quot;</span><span class="c5 c2">Garage Doo</span><span class="c2">r&quot; &amp;&amp; changed.old_state==&quot;Closed&quot; &amp;&amp; changed.new_state==&quot;Opened&quot;)</span></p><p class="c3"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.warn(&quot;</span><span class="c5 c2">garage door has been opened</span><span class="c2">&quot;);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var timerGrg = setTimeout(function()</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{if(context.global.winkState.sensor_pods[&#39;</span><span class="c5 c2">Garage Motion</span><span class="c2">&#39;].motion===false)</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{WinkCMDmsg=context.global.executeWinkCMD(&quot;</span><span class="c5 c2">Close Garage Sequence</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">shortcut</span><span class="c2">&quot;);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.send(WinkCMDmsg)}},</span><span class="c2 c9">30000</span><span class="c2">);</span></p><p class="c3"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c6"><span class="c19 c16"></span></p><p class="c6"><span class="c19 c16"></span></p><p class="c6"><span></span></p><h4 class="c12" id="h.l56ymxkb47r8"><span class="c18 c16">Kitchen light on</span><span>&nbsp;</span></h4><p class="c6"><span></span></p><p class="c3"><span class="c2">if (changed.name==&quot;</span><span class="c5 c2">Kitchen</span><span class="c2">&quot; &amp;&amp; changed.old_state!==true &amp;&amp; changed.new_state===true) </span></p><p class="c3"><span class="c2">{</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; try {</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10">// This command turns my kitchen light on to 100%</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WinkCMDmsg = context.global.executeWinkCMD(&quot;</span><span class="c5 c2">Kitchen Light</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">light</span><span class="c2">&quot;,&rdquo;</span><span class="c5 c2">On</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">100</span><span class="c2">&quot;);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; catch(error){</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.warn(error.message);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; }</span></p><p class="c14"><span>&nbsp; &nbsp; </span></p><p class="c0"><span class="c19 c16"></span></p><h4 class="c12" id="h.n9o0h137bc10"><span class="c18 c16">Kitchen light off after 10 mins no motion</span></h4><p class="c0"><span class="c19 c16"></span></p><p class="c3"><span>&nbsp; </span><span class="c2">&nbsp; if (changed.name==&quot;</span><span class="c5 c2">Kitchen</span><span class="c2">&quot; &amp;&amp; changed.old_state!==false &amp;&amp; changed.new_state===false)</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; {</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; var timerBasementMotion = setTimeout(function()</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(context.global.winkState.sensor_pods[&#39;</span><span class="c5 c2">Kitchen</span><span class="c2">&#39;].motion===false)</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(context.global.executeWinkCMD(&quot;</span><span class="c5 c2">Kitchen Light</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">light</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">off</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">0</span><span class="c2">&quot;));</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.send(context.global.send_ui_note(&#39;information&#39;,</span><span class="c2 c9">30</span><span class="c2">*60*1000,&#39;</span><span class="c5 c2">No Motion Kitchen Light off</span><span class="c2">&#39;,Math.floor(Math.random()*1000)));</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; catch(error){</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node.warn(error.message);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },</span><span class="c2 c9">600000</span><span class="c2">);</span></p><p class="c14"><span>&nbsp; &nbsp; </span></p><h3 class="c12" id="h.oox0igpnzmt3"><span>Remote Based Robots</span></h3><p class="c6"><span></span></p><h4 class="c12" id="h.q3982is109x3"><span class="c18 c4 c16">Activating a schedule using a remote</span></h4><p class="c6 c15"><span class="c2 c16"></span></p><p class="c3"><span class="c2 c16">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c2">if (changed.name==&quot;</span><span class="c5 c2">Master Bedroom Remote</span><span class="c2">&quot; &amp;&amp; context.global.winkState.remotes[&#39;</span><span class="c5 c2">Master Bedroom Remote</span><span class="c2">&#39;].button_off_pressed===true) //Robot: if bottom button on MB remote pushed, activate Alexa Bedtime Shortcut</span></p><p class="c3"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.warn(&quot;</span><span class="c5 c2">bedroom button pressed</span><span class="c2">&quot;);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WinkCMDmsg = context.global.executeWinkCMD(&quot;</span><span class="c5 c2">Alexa Bedtime</span><span class="c2">&quot;,&quot;</span><span class="c5 c2">shortcut</span><span class="c2">&quot;);</span></p><p class="c3"><span class="c2">&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.send(WinkCMDmsg);</span></p><p class="c3"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c6"><span></span></p><p class="c6"><span></span></p><p class="c6"><span></span></p><p class="c6"><span></span></p><h3 class="c12 c17" id="h.2m7p2gwpobuq"><span>Quick Reference</span></h3><p class="c14 c27"><span class="c8">Quick tips to check CURRENT STATE of Wink devices.</span></p><p class="c3 c20"><span class="c8">Presence: context.global.winkState.sensor_pods[&#39;Person Name&#39;].presence===true</span></p><p class="c3 c20"><span class="c8">Motion Sensor: context.global.winkState.sensor_pods[&#39;Sensor Name&#39;].motion===true</span></p><p class="c3 c27"><span class="c8">Trippers: context.global.winkState.sensor_pods[&#39;Tripper Name&#39;].opened===true OR .closed===true</span></p><p class="c3 c20"><span class="c8">Switches: context.global.winkState.binary_switches[&#39;Switch Name&#39;].powered===true OR false</span></p><p class="c3 c20"><span class="c8">Bulbs: context.global.winkState.light_bulbs[&#39;Bulb Name&#39;].powered===true OR .brightness===.8</span></p><p class="c3 c20"><span class="c8">Locks: context.global.winkState.locks[&#39;Lock Name&#39;].locked===true OR .unlocked</span></p><p class="c3 c20"><span class="c8">Groups: context.global.winkState.groups[&#39;Group Name&#39;].powered.or===true OR .powered.and===true</span></p><p class="c3 c20"><span class="c8">*powered.or checks to see if any lights in the group are powered or not, powered.and checks to see if ALL lights in the group are powered or not</span></p><p class="c3 c20"><span class="c8">Can also check state of Cameras, Smoke detectors, using the same format as above. Devices names are case sensitive, true/false, locked/unlocked, opened/closed are always lowercase</span></p><p class="c6"><span class="c11 c4"></span></p><p class="c0"><span class="c13 c4 c16"></span></p><p class="c6 c15"><span class="c16"></span></p><p class="c6 c15"><span class="c16"></span></p><p class="c6 c15"><span class="c16"></span></p><p class="c6 c15"><span class="c16"></span></p><p class="c3"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6 c15"><span class="c16"></span></p><p class="c3"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6 c15"><span class="c16"></span></p><p class="c6 c15"><span class="c16"></span></p><p class="c3"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c6 c15"><span class="c16"></span></p><p class="c6 c15"><span class="c16"></span></p><p class="c6 c15"><span class="c8 c2"></span></p></body></html>